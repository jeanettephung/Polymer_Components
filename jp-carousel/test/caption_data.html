<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>caption data test</title>

    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../node_modules/wct-browser-legacy/browser.js"></script>

    <script type="module" src="../jp-carousel.js"></script>
  </head>
  <body>

    <test-fixture id="Default">
      <template>
        <jp-carousel>
          <img src="https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg">
          <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png">
          <img src="https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg">
          <img src="https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg">
          <img src="https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg">
          <img src="http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg">
          <img src="https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg">
          <img src="https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=">
          <img src="http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg">
          <img src="https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg">
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="Data">
      <template>
        <jp-carousel 
          data='[
            {"src": "https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg"},
            {"src": "https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png"},
            {"src": "https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg"},
            {"src": "https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg"},
            {"src": "https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg"},
            {"src": "http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg"},
            {"src": "https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg"},
            {"src": "https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE="},
            {"src": "http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg"},
            {"src": "https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg"}
          ]'>
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="DefaultNoCaption">
      <template>
        <jp-carousel>
          <img src="https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg" caption="A blue betta">
          <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png" caption="A blue-red betta">
          <img src="https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg" caption="A red betta">
          <img src="https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg" caption="A blue betta">
          <img src="https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg" caption="A red-white betta">
          <img src="http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg" caption="A blue-purple betta">
          <img src="https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg" caption="A red-white-blue betta">
          <img src="https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=" caption="A yellow-white betta">
          <img src="http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg" caption="A white betta">
          <img src="https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg" caption="A white-red betta">
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="DataNoCaption">
      <template>
        <jp-carousel
          data='[
            {"src": "https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg", "caption": "A blue betta"},
            {"src": "https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png", "caption": "A blue-red betta"},
            {"src": "https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg", "caption": "A red betta"},
            {"src": "https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg", "caption": "A blue betta"},
            {"src": "https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg", "caption": "A red-white betta"},
            {"src": "http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg", "caption": "A blue-purple betta"},
            {"src": "https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg", "caption": "A red-white-blue betta"},
            {"src": "https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=", "caption": "A yellow-white betta"},
            {"src": "http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg", "caption": "A white betta"},
            {"src": "https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg", "caption": "A white-red betta"}
        ]'>
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="DefaultCaption">
      <template>
        <jp-carousel caption>
          <img src="https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg" caption="A blue betta">
          <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png" caption="A blue-red betta">
          <img src="https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg" caption="A red betta">
          <img src="https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg" caption="A blue betta">
          <img src="https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg" caption="A red-white betta">
          <img src="http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg" caption="A blue-purple betta">
          <img src="https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg" caption="A red-white-blue betta">
          <img src="https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=" caption="A yellow-white betta">
          <img src="http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg" caption="A white betta">
          <img src="https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg" caption="A white-red betta">
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="DataCaption">
      <template>
        <jp-carousel caption
          data='[
            {"src": "https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg", "caption": "A blue betta"},
            {"src": "https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png", "caption": "A blue-red betta"},
            {"src": "https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg", "caption": "A red betta"},
            {"src": "https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg", "caption": "A blue betta"},
            {"src": "https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg", "caption": "A red-white betta"},
            {"src": "http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg", "caption": "A blue-purple betta"},
            {"src": "https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg", "caption": "A red-white-blue betta"},
            {"src": "https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=", "caption": "A yellow-white betta"},
            {"src": "http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg", "caption": "A white betta"},
            {"src": "https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg", "caption": "A white-red betta"}
        ]'>
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="DefaultCaptionAlt">
      <template>
        <jp-carousel caption>
          <img src="https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg">
          <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png" caption="A blue-red betta">
          <img src="https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg">
          <img src="https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg" caption="A blue betta">
          <img src="https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg">
          <img src="http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg" caption="A blue-purple betta">
          <img src="https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg">
          <img src="https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=" caption="A yellow-white betta">
          <img src="http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg">
          <img src="https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg" caption="A white-red betta">
        </jp-carousel>
      </template>
    </test-fixture>
    
    <test-fixture id="DataCaptionAlt">
      <template>
        <jp-carousel caption
          data='[
            {"src": "https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg"},
            {"src": "https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png", "caption": "A blue-red betta"},
            {"src": "https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg"},
            {"src": "https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg", "caption": "A blue betta"},
            {"src": "https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg"},
            {"src": "http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg", "caption": "A blue-purple betta"},
            {"src": "https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg"},
            {"src": "https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=", "caption": "A yellow-white betta"},
            {"src": "http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg"},
            {"src": "https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg", "caption": "A white-red betta"}
        ]'>
        </jp-carousel>
      </template>
    </test-fixture>
    
     <test-fixture id="ApplyStyle">
      <template>
        <style>
          #ApplyStyle {
            --caption-color: blue;
            --caption-font-family: monospace;
            --caption-font-size: 8px;
            --caption-font-weight: 200;
          }
        </style>
        <jp-carousel caption
          data='[
            {"src": "https://thumbs.dreamstime.com/b/male-crowntail-betta-fish-isolated-black-background-beautiful-blue-77203959.jpg"},
            {"src": "https://upload.wikimedia.org/wikipedia/commons/4/42/Betta_splendens_male_crowntail.png", "caption": "A blue-red betta"},
            {"src": "https://cdn.idropnews.com/wp-content/uploads/2017/03/23164924/Beta-Fish-Wallpaper-Chevanon-Photography-1000x600.jpg"},
            {"src": "https://thumbs.dreamstime.com/b/blue-crowntail-betta-fish-siamese-fighting-fish-black-background-71712481.jpg", "caption": "A blue betta"},
            {"src": "https://thumbs.dreamstime.com/b/red-blue-siamese-fighting-fish-betta-fish-isolated-black-background-58695275.jpg"},
            {"src": "http://fishkeepingadvice.com/wp-content/uploads/siamese-fighting-fish.jpg", "caption": "A blue-purple betta"},
            {"src": "https://static.seattletimes.com/wp-content/uploads/2016/11/66ae45dc30524386bf08aee8a751b279-780x532.jpg"},
            {"src": "https://media.istockphoto.com/photos/white-yellow-siamese-fighting-fish-picture-id601925038?k=6&m=601925038&s=612x612&w=0&h=pOtNyPfF6pEgm_x8Qi1flpLKmJ1tcbOhnEsZ97BO8wE=", "caption": "A yellow-white betta"},
            {"src": "http://www.fubiz.net/wp-content/uploads/2013/11/Stunning-Portraits-of-Fish-1.jpg"},
            {"src": "https://i.pinimg.com/736x/41/f3/ea/41f3eaba447b068d04f27f88f85d8e05--tropical-animals-tropical-fish.jpg", "caption": "A white-red betta"}
        ]'>
        </jp-carousel>
      </template>
    </test-fixture>


    <script>      
      suite('jp-carousel', () => {
        
        function testCase(el, shadow, button, assert1, assert2) {
          for (var i = 0; i < el.children.length; i++) {
            const caption = (el.children[i]).getAttribute('caption');
            assert.equal(caption, null);
            const display = ((shadow.querySelector('.caption')).querySelector('p')).textContent;
            button.click();
            assert.equal(assert1, assert2);
          }
        }

        test('No caption attribute should not display caption', () => {
          const el = fixture('Default');
          const shadow = el.shadowRoot;
          const rightBtn = shadow.querySelector('.button--right');

          const dataEl = fixture('Data');
          const dataShadow = dataEl.shadowRoot;
          const dataRightBtn = dataShadow.querySelector('.button--right');
          
          function testCase(el, shadow, button) {
            for (var i = 0; i < el.children.length; i++) {
              const caption = (el.children[i]).getAttribute('caption');
              assert.equal(caption, null);
              const display = ((shadow.querySelector('.caption')).querySelector('p')).textContent;
              button.click();
            }
          }
          
          testCase(el, shadow, rightBtn);
          testCase(dataEl, dataShadow, dataRightBtn);
        });

        test('With caption attribute with no caption on image display no caption', () => {
          const el = fixture('DefaultNoCaption');
          const shadow = el.shadowRoot;
          const rightBtn = shadow.querySelector('.button--right');
          
          const dataEl = fixture('DataNoCaption');
          const dataShadow = dataEl.shadowRoot;
          const dataRightBtn = dataShadow.querySelector('.button--right');

          function testCase(el, shadow, button) {
            for (var i = 0; i < el.children.length; i++) {
              const caption = (el.children[i]).getAttribute('caption');
              assert.notEqual(caption, null);
              const display = ((shadow.querySelector('.caption')).querySelector('p')).textContent;
              assert.equal(display, '');
              button.click();
            }
          }
          
          testCase(el, shadow, rightBtn);
          testCase(dataEl, dataShadow, dataRightBtn);
        });
        
        test('With caption attribute and caption on image display caption', () => {
          const el = fixture('DefaultCaption');
          const shadow = el.shadowRoot;
          const rightBtn = shadow.querySelector('.button--right');
          
          const dataEl = fixture('DataCaption');
          const dataShadow = dataEl.shadowRoot;
          const dataRightBtn = dataShadow.querySelector('.button--right');

          function testCase(el, shadow, button) {
            for (var i = 0; i < el.children.length; i++) {
              const caption = (el.children[i]).getAttribute('caption');
              const display = ((shadow.querySelector('.caption')).querySelector('p')).textContent;
              assert.equal(display, caption);
              button.click();
            }
          }
          
          testCase(el, shadow, rightBtn);
          testCase(dataEl, dataShadow, dataRightBtn);
        });
        
        test('Images with caption attribute displays caption', () => {
          const el = fixture('DefaultCaptionAlt');
          const shadow = el.shadowRoot;
          const rightBtn = shadow.querySelector('.button--right');
          
          const dataEl = fixture('DataCaptionAlt');
          const dataShadow = dataEl.shadowRoot;
          const dataRightBtn = dataShadow.querySelector('.button--right');
          
          function testCase(el, shadow, button) {
            for (var i = 0; i < el.children.length; i++) {
              const caption = (el.children[i]).getAttribute('caption');
              const display = ((shadow.querySelector('.caption')).querySelector('p')).textContent;

              if (i%2 === 0) assert.equal(display, '');
              else assert.equal(display, caption);
              button.click();
            }
          }
          
          testCase(el, shadow, rightBtn);
          testCase(dataEl, dataShadow, dataRightBtn);
        });
        
        test('Test styles rules: --caption-color, --caption-font-family, --caption-font-size, --caption-font-weight', () => {  
          function checkValues (element, color, fontF, fontS, fontW) {
            const style = window.getComputedStyle(element, null);
            var retval = [];
            
            retval.push(style.getPropertyValue('--caption-color').trim());
            retval.push(style.getPropertyValue('--caption-font-family').trim());
            retval.push(style.getPropertyValue('--caption-font-size').trim());
            retval.push(style.getPropertyValue('--caption-font-weight').trim()); 

            assert.deepEqual(retval, [color, fontF, fontS, fontW]);
          }
          
          function testCase(el, shadow, button) {
            for (var i = 0; i < el.children.length; i++) {
              const caption = (el.children[i]).getAttribute('caption');
              const display = ((shadow.querySelector('.caption')).querySelector('p')).textContent;

              if (i%2 === 0) assert.equal(display, '');
              else assert.equal(display, caption);
              button.click();
            }
          }
          
          const fixtureEl = fixture('ApplyStyle');
          const el = fixtureEl[1];
          checkValues(el, 'blue', 'monospace', '8px', '200');
          
          const shadow = el.shadowRoot;
          const rightBtn = shadow.querySelector('.button--right');
          
          const dataEl = fixture('DataCaptionAlt');
          const dataShadow = dataEl.shadowRoot;
          const dataRightBtn = dataShadow.querySelector('.button--right');
          
          
          testCase(el, shadow, rightBtn);
          testCase(dataEl, dataShadow, dataRightBtn);
          checkValues(el, 'blue', 'monospace', '8px', '200');
        });

      });
    </script>

  </body>
</html>
